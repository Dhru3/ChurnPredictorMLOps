# The Hybrid AI Churn-Bot ğŸ¤–

**An End-to-End MLOps + Generative AI System for Customer Retention**

This project demonstrates a complete hybrid AI system combining **Predictive AI** (MLOps pipeline), **Explainable AI** (SHAP), and **Generative AI** (Google Gemini) to predict customer churn and generate personalized retention strategies.

## ğŸ¯ What Makes This "Hybrid AI"?

This isn't just another ML modelâ€”it's a **three-layer intelligent system**:

1. **ğŸ¯ Predictive AI (MLOps Foundation)**
   - Trains a RandomForest model to predict customer churn
   - Uses MLflow for experiment tracking and model registry
   - Version-controlled models with production staging

2. **ğŸ§  Explainable AI (SHAP Analysis)**
   - Explains *why* each customer is likely to churn
   - Visual waterfall plots showing feature contributions
   - Identifies top risk factors for targeted intervention

3. **âœ¨ Generative AI (Retention Strategies)**
   - Google Gemini generates personalized retention emails
   - Creates custom support scripts for each at-risk customer
   - Provides immediate action plans based on churn factors

## Project Architecture

```
ChurnPredictorMLOps/
â”œâ”€â”€ ğŸ“ Training Pipeline (MLOps)
â”‚   â”œâ”€â”€ train.py              # RandomForest training + MLflow registration
â”‚   â”œâ”€â”€ telco_churn.csv       # Telco Customer Churn dataset
â”‚   â”œâ”€â”€ mlflow.db             # Experiment tracking database
â”‚   â””â”€â”€ mlruns/               # Model artifacts
â”‚
â”œâ”€â”€ ğŸ¤– Hybrid AI Dashboard
â”‚   â”œâ”€â”€ app.py                # Streamlit "Mission Control" interface
â”‚   â””â”€â”€ .env                  # API keys (create from .env.example)
â”‚
â””â”€â”€ ğŸ“¦ Configuration
    â”œâ”€â”€ requirements.txt      # All dependencies
    â””â”€â”€ .env.example          # Template for API keys
```

## ğŸš€ Quick Start Guide

### Step 1: Set Up Your Environment

```bash
# Create virtual environment
python -m venv .venv
source .venv/bin/activate  # On Windows: .venv\Scripts\activate

# Install dependencies
pip install --upgrade pip
pip install -r requirements.txt
```

### Step 2: Configure Generative AI (Optional but Recommended)

Get a **free** Google Gemini API key:
1. Go to https://makersuite.google.com/app/apikey
2. Create a new API key
3. Create `.env` file:

```bash
cp .env.example .env
# Edit .env and add your key:
# GEMINI_API_KEY=your_actual_key_here
```

> ğŸ’¡ **Note**: The app works without an API key, but you won't get AI-generated retention strategies.

### Step 3: Train the MLOps Model

```bash
python train.py
```

**What happens:**
- âœ… Loads and preprocesses Telco dataset
- âœ… Trains RandomForest with 300 estimators
- âœ… Logs to MLflow (params, metrics, artifacts)
- âœ… Registers model as `churn-predictor` Version 1

**Expected output:**
```
Training complete. Accuracy: 0.7842
Successfully registered model 'churn-predictor'.
Created version '1' of model 'churn-predictor'.
```

### Step 4: Promote Model to Production

**Terminal 1 - Start MLflow UI:**
```bash
mlflow ui --backend-store-uri sqlite:///mlflow.db
```

**Browser - Promote Model:**
1. Open http://localhost:5000
2. Click **"Models"** tab
3. Click **"churn-predictor"**
4. Click **Version 1**
5. **"Stage: None"** â†’ Select **"Transition to â†’ Production"**
6. Confirm âœ…

### Step 5: Launch the Hybrid AI Dashboard

**Terminal 2 - Start Streamlit:**
```bash
streamlit run app.py
```

The dashboard opens automatically at **http://localhost:8501** ğŸ‰

## ğŸ“Š Using the Dashboard

### Main Features

1. **ğŸ“‹ Customer Profile Input** (Sidebar)
   - Fill in demographics, services, contract details
   - Click "ğŸ”® Predict Churn"

2. **ğŸ¯ Churn Prediction**
   - Instant probability score
   - Risk level indicator (Low/Moderate/High)
   - Beautiful gauge visualization

3. **ğŸ§  Explainability (SHAP Analysis)**
   - See exactly *why* the model made its prediction
   - Top factors increasing churn risk
   - Top factors reducing churn risk
   - Detailed waterfall plot showing feature contributions

4. **âœ¨ AI Retention Strategy** (For high-risk customers)
   - Personalized retention email (generated by Gemini)
   - Immediate action recommendations
   - Custom discount/offer suggestions
   - Long-term loyalty strategy
   - Downloadable retention plan

### Try These Scenarios

**ğŸ”´ High Risk Customer:**
- Tenure: 1-2 months
- Contract: Month-to-month
- Monthly Charges: $80+
- No additional services (security, backup, etc.)
- Payment: Electronic check

**ğŸŸ¢ Low Risk Customer:**
- Tenure: 60+ months
- Contract: Two year
- Multiple bundled services
- Payment: Bank transfer (automatic)
- Tech support: Yes

## ğŸ“ Technical Highlights

### MLOps Pipeline
- **Framework**: scikit-learn Pipeline (preprocessing + model)
- **Model**: RandomForestClassifier (300 estimators, balanced classes)
- **Tracking**: MLflow experiment logging
- **Registry**: Model versioning with lifecycle stages
- **Backend**: SQLite for self-contained deployment

### Explainable AI
- **Library**: SHAP (SHapley Additive exPlanations)
- **Method**: TreeExplainer for RandomForest
- **Visualization**: Waterfall plots, feature importance
- **Interpretation**: Per-prediction explanations

### Generative AI
- **Model**: Google Gemini Pro
- **Task**: Generate personalized retention strategies
- **Input Context**: Customer profile + SHAP factors
- **Output**: Email templates, action plans, offers

### Frontend
- **Framework**: Streamlit (pure Python, no HTML/CSS needed)
- **Features**: Interactive forms, real-time predictions, beautiful charts
- **Visualization**: Plotly gauges, matplotlib SHAP plots

## ğŸŒŸ What Makes This Project Stand Out

| Feature | Traditional ML | This Hybrid AI System |
|---------|----------------|----------------------|
| Prediction | âœ… Yes | âœ… Yes |
| Model Versioning | âŒ Often manual | âœ… MLflow Registry |
| Explainability | âŒ Black box | âœ… SHAP explanations |
| Actionable Insights | âŒ Just numbers | âœ… AI-generated strategies |
| User Interface | âŒ Code/API only | âœ… Beautiful dashboard |
| Retention Strategy | âŒ Manual work | âœ… Auto-generated by Gemini |

## ğŸ¯ Real-World Applications

This system demonstrates skills valuable for:
- **Customer Success Teams**: Proactive retention campaigns
- **Support Centers**: Personalized customer outreach
- **Product Managers**: Understanding churn drivers
- **Data Scientists**: Full MLOps workflow
- **ML Engineers**: Model deployment and monitoring

## ğŸ“š Learning Outcomes

By exploring this project, you'll understand:

1. **MLOps Best Practices**
   - Experiment tracking with MLflow
   - Model registry and versioning
   - Production staging workflows

2. **Explainable AI**
   - SHAP value computation
   - Feature importance interpretation
   - Communicating model decisions

3. **Hybrid AI Systems**
   - Combining predictive + generative models
   - Building end-to-end intelligent applications
   - Integrating multiple AI technologies

4. **Production ML**
   - Preprocessing pipelines
   - Model serving strategies
   - User-friendly interfaces for ML

## ğŸš€ Next Steps & Extensions

### Beginner
- âœ… Run the complete pipeline
- âœ… Test different customer profiles
- âœ… Compare model versions in MLflow

### Intermediate
- ğŸ”„ Add more features to the model
- ğŸ”„ Experiment with hyperparameters
- ğŸ”„ Try different ML algorithms (XGBoost, LightGBM)
- ğŸ”„ Add A/B testing for retention strategies

### Advanced
- ğŸš€ Deploy to cloud (AWS, GCP, Azure)
- ğŸš€ Add real-time monitoring dashboard
- ğŸš€ Implement feedback loop (track retention success)
- ğŸš€ Build REST API alongside Streamlit
- ğŸš€ Add user authentication
- ğŸš€ Create Docker container for deployment

## ğŸ¤ Talking Points for Interviews/Presentations

*"I built a Hybrid AI system that combines three AI technologies:*

1. ***Predictive AI**: I trained a RandomForest model using a complete MLOps pipeline with MLflow. The model predicts customer churn with 78% accuracy and is version-controlled in a model registry with production staging.*

2. ***Explainable AI**: I integrated SHAP analysis so stakeholders can see exactly why each customer is at risk. This transparency is crucial for building trust with business teams.*

3. ***Generative AI**: For high-risk customers, I use Google Gemini to automatically generate personalized retention strategiesâ€”including custom emails and action plansâ€”based on the specific factors driving that customer's churn risk.*

*The result is a complete system that not only predicts problems but also provides actionable solutions, all accessible through a beautiful Streamlit dashboard that any team member can use."*

## ğŸ› ï¸ Tech Stack

| Component | Technology | Purpose |
|-----------|-----------|---------|
| ML Framework | scikit-learn | Model training & preprocessing |
| MLOps | MLflow | Experiment tracking, model registry |
| Explainability | SHAP | Feature importance, model interpretation |
| Generative AI | Google Gemini | Retention strategy generation |
| Frontend | Streamlit | Interactive dashboard |
| Visualization | Plotly, Matplotlib | Charts and graphs |
| Data | pandas | Data manipulation |
| Storage | SQLite | Lightweight database |

## ğŸ“– Additional Resources

- **MLflow Documentation**: https://mlflow.org/docs/latest/
- **SHAP Tutorials**: https://shap.readthedocs.io/
- **Google Gemini API**: https://ai.google.dev/docs
- **Streamlit Gallery**: https://streamlit.io/gallery

## ğŸ¤ Contributing

This is an educational project demonstrating MLOps + Hybrid AI concepts. Feel free to:
- Fork and enhance
- Add new features
- Create issues for bugs
- Share your implementations

## ğŸ“„ License

Educational project - free to use and modify.

---

<div align="center">

**ğŸ¤– Built with Predictive AI, Explainable AI, and Generative AI**

*Demonstrating the future of intelligent, human-centered ML systems*

</div>
